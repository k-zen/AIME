package io.aime.util;

// Apache Hadoop
import org.apache.hadoop.io.Writable;

// IO
import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;

/**
 * Utility class for counting time.
 *
 * @author K-Zen
 */
public class Timer implements Writable {

    public static enum Time {

        MILLISECOND, SECOND, MINUTE, HOUR
    }
    private long start = 0L;
    private long end = 0L;

    public void starTimer() {
        this.start = System.currentTimeMillis();
    }

    public void endTimer() {
        this.end = System.currentTimeMillis();
    }

    /**
     * Returns the running time in milliseconds.
     *
     * @return The running time.
     */
    public long getExecutionTime() {
        if (this.start > 0L) {
            return (System.currentTimeMillis() - this.start);
        }
        else {
            return 0L;
        }
    }

    /**
     * This method will compute the difference between two times in
     * milliseconds.
     *
     * @param timeUnit The time unit for the response.
     *
     * @return The time difference.
     */
    public double computeOperationTime(Timer.Time timeUnit) {
        switch (timeUnit) {
            case MILLISECOND:
                return (this.end - this.start);
            case SECOND:
                return ((this.end - this.start) / 1000.0);
            case MINUTE:
                return ((this.end - this.start) / 1000.0) / 60;
            case HOUR:
                return ((this.end - this.start) / 1000.0) / 3600;
            default:
                return (this.end - this.start);
        }
    }

    /**
     * This method will compute the difference between two times, but the time
     * is passed as a parameter.
     *
     * @param timeUnit    The time unit for the response.
     * @param elapsedTime The time in milliseconds.
     *
     * @return The time difference.
     */
    public double customComputeOperationTime(Timer.Time timeUnit, long elapsedTime) {
        switch (timeUnit) {
            case MILLISECOND:
                return (elapsedTime);
            case SECOND:
                return (elapsedTime / 1000.0);
            case MINUTE:
                return (elapsedTime / 1000.0) / 60;
            case HOUR:
                return (elapsedTime / 1000.0) / 3600;
            default:
                return (elapsedTime);
        }
    }

    @Override
    public void write(DataOutput out) throws IOException {
        out.writeLong(this.start);
        out.writeLong(this.end);
    }

    @Override
    public void readFields(DataInput in) throws IOException {
        this.start = in.readLong();
        this.end = in.readLong();
    }
}
